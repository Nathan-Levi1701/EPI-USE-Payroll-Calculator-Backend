{
  "Entry": "Gross-to-Net",
  "Plans": {
    "Gross-to-Net": [
      ["Perform", "Loader"],
      ["Perform", "DefineInputs"],
      ["Perform", "Paye"],
      ["Perform", "UIF"],
      ["Perform", "Net"],
      ["Perform", "DefineOutputs"]
    ],
    "Loader": [
      ["Assign", "cap", 2125.44, "Annualised UIF cap"],
      ["Assign", "One_percent", 0.01, "The value multiply by 1 percent"],
      ["Assign", "One", 1, "The value multiply by 1 percent"],
      ["Assign", "Hundred", 100, "Use 100 to divide percentage"],
      ["LoadTable", "Tax_Rebates", "public/assets/json/rebate.json", "Loaded tax rebate table"],
      ["LoadTable", "Tax_Thresholds", "public/assets/json/threshold.json", "Loaded tax threshold table"],
      ["LoadTable", "Tax_Bracket", "public/assets/json/bracket.json", "Load the tax brackets into memory"]
    ],
    "DefineInputs": [
      [
        "DefineExternalInput", "input", "Age", "number", "inputs", 
        {
          "required": true,
          "min": 1,
          "max": 150
        }
      ],
      [
        "DefineExternalInput", "input", "Gross", "number", "inputs", 
        {
          "required": true,
          "min": 1,
          "max": 999999999
        }
      ],
      [
        "DefineExternalInput", "dropdown",
        {
          "PayPeriod": {
            "Monthly": "12",
            "Weekly": "52",
            "Bi Weekly": "26",
            "Daily": "365"
          }
        },
        "number", "inputs",
        {
          "required": true
        }
      ],
      [
        "DefineExternalInput", "dropdown",
        {
          "CalculationType": {
            "Gross-to-Net": "Gross-to-Net",
            "Gross-Up": "grossUp"
          }
        },
        "number", "inputs",
        {
          "required": true
        }
      ]
    ],
    "Paye": [
      ["AccumulativeLookup", "TaxRebate", "Age", "Tax_Rebates", "Rebate", "Tax Rebate defined by Rebate table based on age"],
      ["Lookup", "TaxThreshold", "Age", "Tax_Thresholds", "Tax Threshold defined by Threshold table based on age"],
      ["Calculate", "AnnualGross", "PayPeriod", "*", "Gross", "Annualised Gross amount calculated from income Gross"],
      ["Lookup", "LowerBracketCheck", "AnnualGross", "Tax_Bracket", "Find The lower bracket of the bracket bracket based on annual gross"],
      ["AssignMany", ["LowerBracket", "UpperBracket", "Basis", "Percentage"], "LowerBracketCheck"],
      ["AssignMany", ["MinAge", "MaxAge", "Threshold"], "TaxThreshold"],
      ["AssignMany", ["MinAge", "MaxAge", "Rebate"], "TaxRebate"],
      ["Evaluate", "AnnualGross>Threshold", "AnnualGross", ">", "Threshold",
        [
          ["Calculate", "TaxableGross", "AnnualGross", "-", "LowerBracket", "Get the value of gross that a must have the tax applied to it"],
          ["Calculate", "TaxPercent", "Percentage", "/", "Hundred", "Calculate the percentage in a usable form"],
          ["Calculate", "PercentOfGross", "TaxPercent", "*", "TaxableGross", "Get the percent of annualGross in a number"],
          ["Calculate", "TaxBeforeRebate", "Basis", "+", "PercentOfGross", "Add the tax amount to the basis to determine tax before rebate"],
          ["Calculate", "TaxAfterRebate", "TaxBeforeRebate", "-", "TaxRebate", "Subtract Rebate from Prerebate tax to determine final tax amount"],
          ["Calculate", "DeannualisedTax", "TaxAfterRebate", "/", "PayPeriod", "DeAnnualise the After Rebate Tax Amount to determine Tax at Pay"]
        ],
        [
          ["Assign", "TaxAfterRebate", "0", "Pay falls under the threshold and thus no income tax is paid"],
          ["Calculate", "DeannualisedTax", "TaxAfterRebate", "/", "PayPeriod", "DeAnnualise the After Rebate Tax Amount to determine Tax at Pay"]
        ],
        "Checks if AnnualGross is more than the Threshold."
      ]
    ],
    "UIF": [
      ["Calculate", "DeannualisedUIFCap", "cap", "/", "PayPeriod", "Find the UIF cap for this pay period"],
      ["Calculate", "RawUIF", "Gross", "*", "One_percent", "Calculate 1% of annualised gross"],
      ["Evaluate", "RawUIF>DeannualisedUIFCap", "RawUIF", ">", "DeannualisedUIFCap",
        [
          ["Calculate", "UIF", "cap", "/", "PayPeriod", "Calculate 1% of annualised gross"]
        ],
        [
          ["Calculate", "UIF", "Gross", "*", "One_percent", "Calculate 1% of annualised gross"]
        ],
        "Checks if RawUIF is more than the DeannualisedUIFCap."
      ]
    ],
    "Net": [
      ["Calculate", "MonthlyWitholding", "DeannualisedTax", "+", "UIF", "Calculate the amount That is removed from the monthly Salary"],
      ["Calculate", "MonthlyFinal", "Gross", "-", "MonthlyWitholding", "Calculate the final pay after UIF and Tax Are Deducted"]
    ],
    "DefineOutputs": [
      ["DefineExternalOutput", "Gross", "output"],
      ["DefineExternalOutput", "UIF", "output"],
      ["DefineExternalOutput", "DeannualisedTax", "output"],
      ["DefineExternalOutput", "MonthlyWitholding", "output"],
      ["DefineExternalOutput", "MonthlyFinal", "output"]
    ]
  }
}